# News API 설계서

## 1. 기본 정보

- **Base URL**: `http://localhost:8080/api`
- **Content-Type**: `application/json`
- **인증 방식**: JWT Token (필요시)

## 2. 공통 응답 형식

```json
{
  "success": true,
  "data": {},
  "message": ""
}
```

## 3. 사용자 인증 API

### 3.1 회원가입
- **POST** `/auth/signup`
- **Description**: 사용자 이름, 이메일, 비밀번호를 요청 body로 받아 회원 가입을 진행합니다.
- **Request Body**:
```json
{
  "username": "testuser",
  "email": "test@example.com",
  "password": "Test1234!"
}
```
- **Response**: 
  - `201`: 회원가입 성공
  - `400`: 유효성 검사 실패 (이메일 형식 등)
  - `409`: 중복된 이메일

### 3.2 로그인
- **POST** `/auth/signin`
- **Description**: 이메일, 비밀번호를 요청 body로 받아 로그인을 진행합니다.
- **Request Body**:
```json
{
  "email": "test@example.com",
  "password": "Test1234!"
}
```
- **Response**: `200 OK`
- **Response Body**:
```json
{
  "accessToken": "string",
  "username": "string"
}
```

### 3.3 토큰 재발급
- **POST** `/auth/refresh`
- **Description**: HTTP Only Cookie에 저장된 refresh token 값으로 access token을 재발급합니다.
- **Parameters**:
  - `refreshToken` (string, cookie): 리프레시 토큰
- **Response**: `200 OK`
- **Response Body**:
```json
{
  "accessToken": "string",
  "username": "string"
}
```

### 3.4 이메일 발송
- **POST** `/auth/email`
- **Request Body**:
```json
{
  "email": "string"
}
```
- **Response**: `200 OK`
- **Response Body**:
```json
"string"
```

### 3.5 이메일 인증
- **POST** `/auth/email/verify`
- **Request Body**:
```json
{
  "email": "string",
  "code": "string"
}
```
- **Response**: `200 OK`
- **Response Body**:
```json
"string"
```

## 4. 뉴스 API

### 4.1 뉴스 추가 (복수)
- **POST** `/news/adds`
- **Request Body**:
```json
{
  "companyName": "string",
  "title": "string",
  "contents": "string",
  "publishDate": "2025-07-11"
}
```
- **Response**: `200 OK`

### 4.2 뉴스 추가 (단수)
- **POST** `/news/add`
- **Request Body**:
```json
{
  "companyName": "string",
  "title": "string",
  "contents": "string",
  "publishDate": "2025-07-11"
}
```
- **Response**: `200 OK`

### 4.3 뉴스 제목 조회
- **GET** `/news/{id}/title`
- **Parameters**:
  - `id` (integer, required): 뉴스 ID (path parameter)
- **Response**: `200 OK`
- **Response Body**:
```json
"string"
```

### 4.4 뉴스 상세 조회
- **GET** `/news/{id}/detail`
- **Parameters**:
  - `id` (integer, required): 뉴스 ID (path parameter)
- **Response**: `200 OK`
- **Response Body**:
```json
{
  "title": "string",
  "contents": "string"
}
```

### 4.5 회사별 뉴스 조회
- **GET** `/news/{company}`
- **Parameters**:
  - `company` (string, required): 회사명 (path parameter)
- **Response**: `200 OK`
- **Response Body**:
```json
[
  {
    "id": 0,
    "title": "string",
    "publishDate": "2025-07-11"
  }
]
```

### 4.6 뉴스 제목 목록 조회
- **GET** `/news/titles`
- **Response**: `200 OK`
- **Response Body**:
```json
[
  {
    "id": 0,
    "title": "string"
  }
]
```

### 4.7 회사 목록 조회
- **GET** `/news/companies`
- **Response**: `200 OK`
- **Response Body**:
```json
[
  "string"
]
```

## 5. 채팅 API

### 5.1 뉴스 요약 챗봇
- **POST** `/chat/summarize/{newsId}`
- **Description**: 특정 뉴스 ID에 대한 요약을 제공하는 챗봇 API
- **Parameters**:
  - `newsId` (integer, required): 뉴스 ID (path parameter)
- **Response**: `200 OK`
- **Response Body**:
```json
{
  "summary": "string",
  "error": true,
  "error_content": "string"
}
```

### 5.2 파일 기반 채팅
- **POST** `/chat/chat-with-file`
- **Description**: 파일을 첨부하여 채팅을 진행하는 API
- **Request Body** (multipart/form-data):
  - `request` (string, required): 채팅 요청 내용
  - `file` (binary, required): 첨부 파일
- **Response**: `200 OK`
- **Response Body**:
```json
{
  "sessionId": 0,
  "chatMessageId": 0,
  "question": "string",
  "answer": "string"
}
```

### 5.3 핑 테스트
- **GET** `/chat/ping`
- **Description**: 채팅 서비스의 상태를 확인하는 헬스체크 API
- **Response**: `200 OK`
- **Response Body**:
```json
{
  "message": "string"
}
```

## 6. FastAPI 명세 추가

* **Base URL**: `http://llm-svc:8000`

### 6.1 헬스 체크

* **GET** `/`
* **Response**:

```json
{
  "message": "AI Agent 서버가 실행 중입니다. /docs 로 이동하여 API를 테스트하세요."
}
```

### 6.2 /chat 프롬프트형 챗봇

* **POST** `/chat`
* **Request Body**:

```json
{
  "session_id": 0,
  "user_id": 0,
  "question": "string",
  "chat_message_id": 0,
  "news_id": 0,
  "company": "string",
  "chat_history": []
}
```

* **Response Body**:

```json
{
  "session_id": 0,
  "chat_message_id": 0,
  "question": "string",
  "answer": "string"
}
```

### 6.3 /summarize 뉴스  요약 추출

* **POST** `/summarize`
* **Request Body**:

```json
{
  "id": 0,
  "title": "string",
  "content": "string",
  "companyName": "string"
}
```

* **Response Body**:

```json
{
  "summary": "string",
  "error": false,
  "error_content": "string"
}
```

## 7. HTTP 상태 코드

| 코드 | 설명 |
|------|------|
| 200 | 성공 |
| 201 | 생성 성공 |
| 400 | 잘못된 요청 |
| 401 | 인증 실패 |
| 404 | 리소스를 찾을 수 없음 |
| 409 | 중복 리소스 |
| 500 | 서버 내부 오류 |